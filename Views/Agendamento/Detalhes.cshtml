@model AgendaTatiNails.Models.Atendimento

@{
    ViewData["Title"] = "Detalhes do Agendamento";
}

@section Styles {
    <link rel="stylesheet" href="~/css/Agendamento/crud-page.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/css/Admin/admin.css" asp-append-version="true" />

    <style>
        /* Estilos */
        .details-actions {
            margin-top: 2rem;
            border-top: 1px solid #eee;
            padding-top: 1.5rem;
            display: flex;
            gap: 1rem;
        }
    </style>
}

<div class="crud-container">
    <div class="crud-card">

        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 2rem;">
            <h1 class="crud-title" style="text-align: left; margin: 0;">@ViewData["Title"]</h1>
            <a asp-action="ListaServico" asp-controller="Servico" class="btn btn-secondary">← Voltar para Lista</a>
        </div>
        
        <div class="confirmation-details">
            <dl>
                <dt>Serviço(s)</dt>
                <dd>@(Model.Servicos.Any() ? string.Join(", ", Model.Servicos.Select(s => s.ServicoDesc)) : "N/A")</dd>

                <dt>Data e Hora</dt>
                <dd>@Model.AtendDataAtend.ToString("dd/MM/yyyy 'às' HH:mm")</dd>

                <dt>Status</dt>
                <dd>@Html.Raw(GetStatusBadge(Model.AtendStatus))</dd>

                <dt>Preço Final</dt>
                <dd>@(Model.AtendPrecoFinal?.ToString("C", System.Globalization.CultureInfo.GetCultureInfo("pt-BR")) ?? "Aguardando")</dd>

                <dt>Duração Estimada</dt>
                <dd>@(Model.Servicos.Sum(s => s.ServicoDuracao).ToString()) minutos</dd>
            </dl>
        </div>

        <div class="details-actions">
            <a asp-controller="Agendamento" asp-action="Editar" asp-route-id="@Model.AtendId" class="btn btn-warning">Editar</a>
            <a asp-controller="Agendamento" asp-action="Excluir" asp-route-id="@Model.AtendId" class="btn btn-danger">Cancelar Agendamento</a>
        </div>

    </div>
</div>

@functions {
    public string GetStatusBadge(int status)
    {
        return status switch
        {
            1 => "<span class=\"badge status-agendado\">Agendado</span>",
            2 => "<span class=\"badge status-concluido\">Concluído</span>",
            3 => "<span class=\"badge status-cancelado\">Cancelado</span>",
            _ => "<span class=\"badge status-desc\">Desconhecido</span>"
        };
    }
}


@section Scripts {
    <style>
        .btn-warning {
            color: #000;
            background-color: #ffc107;
            border-color: #ffc107;
            padding: 0.6rem 1.2rem; border-radius: 8px; font-weight: 600;
            text-decoration: none; display: inline-flex; align-items: center;
            justify-content: center; transition: all 0.2s;
            font-family: var(--fonte-titulo); white-space: nowrap;
            border: 1px solid transparent;
        }
        .btn-warning:hover {
            color: #000;
            background-color: #ffca2c;
            border-color: #ffc720;
            transform: translateY(-2px);
        }
    </style>
}